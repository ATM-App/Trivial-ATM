:root {
    --atleti-red: #CB3524; --atleti-blue: #272E61; --bg-color: #F2F2F7;
    --card-bg: rgba(255, 255, 255, 0.9); --text-main: #1C1C1E;
    --gold: #FFD700; --silver: #C0C0C0; --bronze: #CD7F32;
}

* { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Montserrat', sans-serif; -webkit-tap-highlight-color: transparent; }
body { background-color: var(--bg-color); color: var(--text-main); min-height: 100vh; overflow-x: hidden;}

.screen { display: none; width: 100%; min-height: 100vh; padding: 20px; flex-direction: column; align-items: center; animation: fadeIn 0.4s ease; max-width: 1400px; margin: 0 auto; }
.screen.active { display: flex; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

.logo { width: 130px; margin-bottom: 20px; }
.animated-logo { animation: float 3s ease-in-out infinite; }
@keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-12px); } 100% { transform: translateY(0px); } }

h1 { color: var(--atleti-blue); font-weight: 800; text-align: center; margin-bottom: 20px;}
h2 { font-size: 1.2rem; color: var(--atleti-blue); margin-bottom: 15px;}

.ios-card { background: var(--card-bg); border-radius: 20px; padding: 20px; width: 100%; margin-bottom: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.05); }

/* Reglas */
.rules-container { display: flex; gap: 15px; flex-wrap: wrap; }
.rule-column { flex: 1; min-width: 220px; background: rgba(0,0,0,0.03); padding: 15px; border-radius: 12px; }
.rule-column h3 { font-size: 0.95rem; color: var(--atleti-red); margin-bottom: 10px; border-bottom: 2px solid rgba(203, 53, 36, 0.2); padding-bottom: 5px;}
.rule-column ul { list-style: none; padding: 0; margin: 0; }
.rule-column li { display: flex; justify-content: space-between; font-size: 0.85rem; margin-bottom: 8px; border-bottom: 1px dashed #E5E5EA; padding-bottom: 4px; color: #444;}
.rule-column li:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0;}
.rule-column li strong { color: var(--atleti-blue); background: white; padding: 2px 8px; border-radius: 8px; font-size: 0.8rem; box-shadow: 0 1px 3px rgba(0,0,0,0.05);}

.input-group { display: flex; gap: 10px; margin-bottom: 10px; }
input[type="text"], input[type="number"], select { flex: 1; padding: 12px 15px; border-radius: 12px; border: 1px solid #D1D1D6; background: #fff; font-size: 16px; outline: none; }
input:focus, select:focus { border-color: var(--atleti-blue); }

.ios-btn, .ios-btn-small { border: none; border-radius: 14px; font-weight: 800; cursor: pointer; transition: transform 0.1s; text-align: center; }
.ios-btn:active { transform: scale(0.96); }
.ios-btn:disabled { opacity: 0.5; cursor: not-allowed; }
.ios-btn.primary { background: var(--atleti-blue); color: white; padding: 16px; width: 100%; font-size: 1.1rem; }
.ios-btn.secondary { background: var(--atleti-red); color: white; padding: 16px; width: 100%; font-size: 1.1rem; }
.ios-btn.danger-solid { background: #FF3B30; color: white; padding: 16px; width: 100%; font-size: 1.1rem; box-shadow: 0 4px 10px rgba(255, 59, 48, 0.3); }
.ios-btn-small { background: var(--atleti-red); color: #FFFFFF !important; width: 45px; font-size: 1.8rem; display: flex; align-items: center; justify-content: center; padding-bottom: 4px; }
.ios-btn.text-only { background: transparent; color: var(--atleti-blue); padding: 10px; margin-top: 10px; width: 100%;}

/* BOTÓN VAR MEJORADO */
.btn-var {
    width: 100%; border: none; border-radius: 14px; cursor: pointer;
    background: linear-gradient(135deg, #FFD700, #FDB931);
    color: #111; font-weight: 900; font-size: 1.1rem; padding: 16px;
    box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
    text-transform: uppercase; letter-spacing: 1px;
    transition: transform 0.1s, box-shadow 0.1s;
    margin-bottom: 10px;
}
.btn-var:active { transform: scale(0.96); box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3); }

.floating-btn { margin-top: auto; margin-bottom: 20px; box-shadow: 0 10px 20px rgba(39, 46, 97, 0.3); }

#players-list { list-style: none; max-height: 200px; overflow-y: auto; }
#players-list li { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #E5E5EA; }
.delete-btn { background: #FF3B30; color: white; border: none; border-radius: 50%; width: 28px; height: 28px; font-weight: bold; cursor: pointer; }

::-webkit-scrollbar { display: none; }
* { -ms-overflow-style: none; scrollbar-width: none; }

#reveal-container { width: 100%; display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; margin-bottom: 30px; }
.reveal-card { background: white; border-radius: 16px; padding: 15px; width: 45%; min-width: 200px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); opacity: 0; transform: translateY(20px); animation: slideUpCard 0.5s forwards ease-out; border-top-width: 6px; border-top-style: solid; }
@keyframes slideUpCard { to { opacity: 1; transform: translateY(0); } }
.reveal-card h3 { font-size: 1rem; margin-bottom: 10px; }
.reveal-card ul { list-style: none; padding-left: 5px; }
.reveal-card li { font-size: 0.95rem; color: #333; margin-bottom: 6px; font-weight: 500;}

/* Layout Juego */
.screen.game-layout { display: none; padding: 10px; }
.screen.game-layout.active { display: grid; grid-template-columns: 1fr; gap: 20px; align-items: start; }
.sidebar { display: flex; flex-direction: column; gap: 10px; }
.sidebar h3 { text-align: center; color: var(--atleti-blue); font-size: 1rem; margin-bottom: 10px;}
.sidebar-list { display: flex; flex-direction: column; gap: 10px; position: relative;}

.score-card-mini { padding: 12px 15px; border-radius: 12px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 8px rgba(0,0,0,0.06); border-left-width: 6px; border-left-style: solid; transition: all 0.3s ease; gap: 15px; position: relative; }
.score-card-mini.active-turn { transform: scale(1.05); box-shadow: 0 8px 15px rgba(0,0,0,0.15); border-left-width: 10px;}
.team-name-mini { font-weight: 800; font-size: 0.9rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; flex: 1;}
.team-score-mini { font-weight: 800; color: #111; font-size: 1.1rem; white-space: nowrap;}

.main-content { display: flex; flex-direction: column; align-items: center; width: 100%; position: relative; }
.header { text-align: center; margin-bottom: 10px; }

/* Tiempos y VAR */
.timer-container { width: 100%; max-width: 400px; height: 25px; background: #E5E5EA; border-radius: 20px; margin-bottom: 15px; position: relative; overflow: hidden; box-shadow: inset 0 2px 5px rgba(0,0,0,0.1); }
.timer-bar { width: 100%; height: 100%; background: #34C759; transition: width 1s linear, background-color 0.3s; }
#timer-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-weight: 800; font-size: 0.85rem; color: white; text-shadow: 0 1px 2px rgba(0,0,0,0.5); }
.var-indicator { background: var(--text-main); color: var(--gold); padding: 8px 20px; border-radius: 20px; font-weight: 900; margin-bottom: 15px; animation: pulseVAR 1s infinite alternate; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
@keyframes pulseVAR { from { transform: scale(1); } to { transform: scale(1.05); } }

.question-container { width: 100%; display: flex; align-items: center; justify-content: center; padding: 0; margin-bottom: 20px; }
.question-container img { width: 100%; max-height: 55vh; object-fit: contain; filter: drop-shadow(0px 10px 20px rgba(0,0,0,0.2)); }

.game-controls { width: 100%; max-width: 500px; display: flex; flex-direction: column; gap: 10px; }
.mobile-footer-actions { width: 100%; max-width: 400px; margin: 20px auto 0; text-align: center; }

@media (min-width: 768px) {
    .screen.game-layout.active { grid-template-columns: 260px 1fr; padding: 20px; height: 100vh; overflow: hidden; }
    .screen.game-layout.active.use-both-sidebars { grid-template-columns: 240px 1fr 240px; }
    .sidebar { height: 90vh; overflow-y: auto; padding-right: 5px;}
    .main-content { height: 90vh; overflow-y: auto; padding: 0 20px; justify-content: flex-start;}
    .question-container img { max-height: 65vh; } 
    #sidebar-right h3 { display: none; }
    #sidebar-right .sidebar-list { margin-top: 0 !important; }
    .mobile-footer-actions { position: absolute; bottom: 20px; right: 20px; width: 200px; margin: 0;}
}

@media (max-width: 767px) {
    .sidebar h3 { display: none; }
    .sidebar { width: 100%; }
    .sidebar-list { flex-direction: row; overflow-x: auto; padding-bottom: 10px; gap: 10px; }
    #sidebar-left, #sidebar-right { margin-bottom: 0; }
    #sidebar-right .sidebar-list { margin-top: 0 !important; padding-left: 0; border-left: none;}
    .score-card-mini { min-width: max-content; padding: 10px 15px; }
}

/* Modales */
.modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); backdrop-filter: blur(5px); display: none; justify-content: center; align-items: center; z-index: 1000; }
.modal-overlay.active { display: flex; }
.modal-content { max-width: 90%; width: 400px; animation: scaleUp 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
@keyframes scaleUp { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
.score-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
.score-row select { max-width: 80px; text-align: center; font-weight: bold;}

/* Tarjeta Roja Animación */
.red-card-container { display: flex; flex-direction: column; align-items: center; justify-content: center; animation: redCardPop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
.red-card-visual { font-size: 150px; line-height: 1; text-shadow: 0 10px 30px rgba(255,0,0,0.5); animation: shake 0.5s 0.5s ease-in-out; }
.red-card-text { color: white; font-size: 2.5rem; font-weight: 900; margin-top: 20px; text-shadow: 2px 2px 10px rgba(0,0,0,0.8); text-align: center;}
.red-card-subtext { color: #FFCCCB; font-size: 1.5rem; font-weight: bold; text-align: center;}
@keyframes redCardPop { 0% { transform: scale(0) rotate(-20deg); opacity: 0; } 100% { transform: scale(1) rotate(0deg); opacity: 1; } }
@keyframes shake { 0%, 100% { transform: translateX(0); } 20%, 60% { transform: translateX(-15px) rotate(-5deg); } 40%, 80% { transform: translateX(15px) rotate(5deg); } }

/* Puntos Flotantes Animación */
.floating-score-anim { position: fixed; font-size: 3rem; font-weight: 900; color: #34C759; text-shadow: 0 4px 10px rgba(0,0,0,0.3); pointer-events: none; z-index: 2000; transition: all 1s cubic-bezier(0.25, 1, 0.5, 1); }

/* Pódium */
.podium-container { display: flex; justify-content: center; align-items: flex-end; gap: 10px; min-height: 400px; margin: 40px 0; width: 100%;}
.podium-spot { display: flex; flex-direction: column; align-items: center; width: 30%; text-align: center; }
.podium-spot h3 { font-size: 1.1rem; margin-bottom: 10px; font-weight: 800;}
.podium-spot p { font-size: 1.8rem; font-weight: 900; margin-top: 15px; color: var(--atleti-blue); text-shadow: 1px 1px 0px rgba(0,0,0,0.1); }
.members-list { display: flex; flex-wrap: wrap; justify-content: center; gap: 6px; margin-bottom: 15px; min-height: 80px; align-items: flex-end;}
.player-badge { padding: 6px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: 800; text-transform: uppercase; letter-spacing: 0.5px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
.gold-badge { background: #FFF9C4; color: #B8860B; border: 1px solid #FFD700; }
.silver-badge { background: #F5F5F5; color: #616161; border: 1px solid #E0E0E0; }
.bronze-badge { background: #EFEBE9; color: #5D4037; border: 1px solid #D7CCC8; }
.bar { width: 100%; border-top-left-radius: 15px; border-top-right-radius: 15px; display: flex; justify-content: center; align-items: center; color: white; font-weight: bold; font-size: 2rem; text-shadow: 0 2px 4px rgba(0,0,0,0.3);}
.gold .bar { background: linear-gradient(135deg, #FFD700, #FDB931); height: 200px; box-shadow: 0 -10px 20px rgba(255,215,0,0.4); z-index: 10;} 
.silver .bar { background: linear-gradient(135deg, #E0E0E0, #9E9E9E); height: 140px; } 
.bronze .bar { background: linear-gradient(135deg, #CD7F32, #A0522D); height: 100px; }
.hidden { display: none !important; }